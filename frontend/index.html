<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="AssistMe">
    <meta name="theme-color" content="#10a37f">
    <meta name="format-detection" content="telephone=no">
    <title>AssistMe · AI Assistant</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Cdefs%3E%3ClinearGradient id='g'%3E%3Cstop offset='0' stop-color='%2310a37f'/%3E%3Cstop offset='1' stop-color='%233b82f6'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='32' height='32' rx='8' fill='%230b1728'/%3E%3Cpath d='M16 6c5.5 0 10 4.5 10 10s-4.5 10-10 10S6 21.5 6 16 10.5 6 16 6zm0 3a7 7 0 100 14 7 7 0 000-14z' fill='url(%23g)'/%3E%3Ccircle cx='16' cy='16' r='3.5' fill='%23fff'/%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Cdefs%3E%3ClinearGradient id='g'%3E%3Cstop offset='0' stop-color='%2310a37f'/%3E%3Cstop offset='1' stop-color='%233b82f6'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='180' height='180' rx='40' fill='%230b1728'/%3E%3Cpath d='M90 34c31 0 56 25 56 56s-25 56-56 56-56-25-56-56 25-56 56-56zm0 17a39 39 0 100 78 39 39 0 000-78z' fill='url(%23g)'/%3E%3Ccircle cx='90' cy='90' r='19.5' fill='%23fff'/%3E%3C/svg%3E">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/styles/github.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <meta name="assistme-api-base" content="http://localhost:8001">
</head>
<body>
    <div class="app" id="app">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar" aria-label="Conversation history">
            <div class="sidebar-header">
                <button class="sidebar-btn primary" id="newChatBtn">
                    <i class="fa-solid fa-plus" aria-hidden="true"></i>
                    <span>New chat</span>
                </button>
                <button class="icon-btn mobile-only" id="sidebarCloseBtn" aria-label="Close sidebar">
                    <i class="fa-solid fa-xmark" aria-hidden="true"></i>
                </button>
            </div>

            <div class="sidebar-search">
                <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
                <input type="search" id="conversationSearch" placeholder="Search conversations" autocomplete="off">
            </div>

            <div class="sidebar-section">
                <div class="sidebar-section-header">
                    <span>Recent</span>
                    <button class="text-btn" id="clearHistoryBtn">Clear</button>
                </div>
                <nav class="conversation-list" id="conversations" aria-live="polite"></nav>
            </div>

            <div class="sidebar-section pinned" id="pinnedSection">
                <div class="sidebar-section-header">
                    <span>Pinned prompts</span>
                </div>
                <div class="pinned-list" id="pinnedPrompts">
                    <button class="pinned-item" data-prompt="Summarise the latest meeting notes and highlight key decisions.">
                        <i class="fa-solid fa-thumbtack"></i>
                        <span>Summarise meeting notes</span>
                    </button>
                    <button class="pinned-item" data-prompt="Draft an email updating the team on the project status towards the Q4 launch.">
                        <i class="fa-solid fa-thumbtack"></i>
                        <span>Project status update</span>
                    </button>
                    <button class="pinned-item" data-prompt="Generate a list of experiment ideas to increase onboarding completion by 15%.">
                        <i class="fa-solid fa-thumbtack"></i>
                        <span>Activation experiment ideas</span>
                    </button>
                </div>
            </div>

            <div class="sidebar-footer">
                <button class="sidebar-footer-btn" id="settingsBtn">
                    <i class="fa-solid fa-circle-user" aria-hidden="true"></i>
                    <span>Workspace settings</span>
                </button>
                <button class="sidebar-footer-btn" id="themeToggleBtn">
                    <i class="fa-solid fa-moon" aria-hidden="true"></i>
                    <span>Toggle theme</span>
                </button>
            </div>
        </aside>

        <!-- Main Workspace -->
        <main class="workspace" id="workspace">
            <header class="workspace-header">
                <div class="workspace-brand">
                    <button class="icon-btn" id="sidebarToggle" aria-label="Toggle sidebar">
                        <i class="fa-solid fa-bars" aria-hidden="true"></i>
                    </button>
                    <div class="brand-text">
                        <span class="brand-title">AssistMe</span>
                        <span class="brand-subtitle">AI assistant</span>
                    </div>
                </div>
                <div class="workspace-actions">
                    <div class="model-switcher" id="modelSelector">
                        <button class="model-button" id="modelButton" aria-haspopup="listbox" aria-expanded="false">
                            <div class="model-primary">
                                <span class="model-name">Select a model</span>
                                <span class="model-hint">Pick any model to start chatting</span>
                            </div>
                            <i class="fa-solid fa-chevron-down" aria-hidden="true"></i>
                        </button>
                        <div class="model-dropdown" id="modelDropdown" role="listbox">
                            <!-- Models populated by JavaScript -->
                        </div>
                    </div>
                    <button class="icon-btn benchmark-btn" id="benchmarkBtn" aria-haspopup="dialog">
                        <i class="fa-solid fa-gauge-high" aria-hidden="true"></i>
                        <span>Benchmark</span>
                    </button>
                </div>
            </header>

            <!-- Status Bar -->
            <section class="assistant-status" id="assistantStatus">
                <span class="status-dot live"></span>
                <span>All systems operational · Responses stream in realtime</span>
            </section>

            <div class="workspace-scroll" id="workspaceScroll">
                <!-- Welcome Panel -->
                <section class="welcome" id="welcomePanel">
                    <div class="welcome-header">
                        <h1>How can I help you today?</h1>
                        <p>Ask me anything. Get instant answers, creative ideas, and helpful insights.</p>
                    </div>
                    <div class="welcome-grid" id="starterGrid">
                        <button class="welcome-card" data-prompt="Explain quantum computing in simple terms">
                            <span class="card-category">Explain</span>
                            <p>Explain quantum computing in simple terms</p>
                            <span class="card-hint">Clear, accessible explanation</span>
                        </button>
                        <button class="welcome-card" data-prompt="Write a Python function to reverse a string">
                            <span class="card-category">Code</span>
                            <p>Write a Python function to reverse a string</p>
                            <span class="card-hint">Clean, efficient code</span>
                        </button>
                        <button class="welcome-card" data-prompt="Help me plan a healthy meal for the week">
                            <span class="card-category">Planning</span>
                            <p>Help me plan a healthy meal for the week</p>
                            <span class="card-hint">Balanced nutrition guide</span>
                        </button>
                        <button class="welcome-card" data-prompt="Summarize the key points from recent AI developments">
                            <span class="card-category">Research</span>
                            <p>Summarize the key points from recent AI developments</p>
                            <span class="card-hint">Latest breakthroughs</span>
                        </button>
                    </div>
                </section>

                <!-- Chat Thread -->
                <section class="chat-thread" id="chatThread" aria-live="polite">
                    <div class="message-stream" id="chatMessages"></div>
                </section>
            </div>

            <!-- Composer -->
            <footer class="composer" id="composer">
                <div class="composer-toolbar">
                    <div class="composer-suggestions" id="inlineSuggestions">
                        <button class="suggestion-pill" data-prompt="Explain this code">Explain code</button>
                        <button class="suggestion-pill" data-prompt="Make this more concise">Make concise</button>
                        <button class="suggestion-pill" data-prompt="Add error handling">Add error handling</button>
                    </div>
                    <div class="composer-metrics">
                        <span id="latencyMetric">—</span>
                        <span id="tokenMetric">— tokens</span>
                    </div>
                    <div class="composer-toggles" id="ragToggle">
                        <label class="toggle">
                            <input type="checkbox" id="ragCheckbox" checked>
                            <span>Ground with Grokipedia</span>
                        </label>
                    </div>
                </div>

                <div class="composer-box">
                    <button class="icon-btn" id="uploadBtn" title="Attach files">
                        <i class="fa-solid fa-plus" aria-hidden="true"></i>
                    </button>
                    <div class="textarea-wrapper">
                        <div class="composer-quick" id="composerQuick">
                            <button type="button" class="quick-btn" data-format="bold" title="Bold (⌘/Ctrl + B)">
                                <i class="fa-solid fa-bold" aria-hidden="true"></i>
                            </button>
                            <button type="button" class="quick-btn" data-format="italic" title="Italic (⌘/Ctrl + I)">
                                <i class="fa-solid fa-italic" aria-hidden="true"></i>
                            </button>
                            <button type="button" class="quick-btn" data-format="code" title="Inline code (⌘/Ctrl + E)">
                                <i class="fa-solid fa-code" aria-hidden="true"></i>
                            </button>
                            <button type="button" class="quick-btn" data-format="clear" title="Clear input">
                                <i class="fa-solid fa-eraser" aria-hidden="true"></i>
                            </button>
                        </div>
                        <textarea id="messageInput" rows="1" placeholder="Message AssistMe..." autocomplete="off"></textarea>
                        <div class="input-hint desktop-hint">Press Shift + Enter for new line</div>
                        <div class="input-hint mobile-hint">Tap mic to speak · Tap send to submit</div>
                    </div>
                    <div class="composer-actions">
                        <button class="icon-btn" id="voiceBtn" title="Audio transcription (speech-to-text)">
                            <i class="fa-solid fa-microphone" aria-hidden="true"></i>
                        </button>
                        <button class="icon-btn voice-mode-btn" id="voiceModeBtn" title="Voice conversation mode (like ChatGPT/Gemini Live)">
                            <i class="fa-solid fa-podcast" aria-hidden="true"></i>
                        </button>
                        <button class="icon-btn" id="agentPlanBtn" title="Plan next steps with MiniMax">
                            <i class="fa-solid fa-list-check" aria-hidden="true"></i>
                        </button>
                        <button class="send-btn disabled" id="sendButton" disabled aria-label="Send message">
                            <i class="fa-solid fa-arrow-up" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
                <div class="composer-footnote">
                    <div class="agent-panel" id="agentPanel" aria-live="polite"></div>
                    <span class="footnote-copy">AssistMe can make mistakes. Consider checking important information.</span>
                </div>
            </footer>
        </main>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer" aria-live="polite"></div>

    <!-- Connection Status -->
    <div class="connection-status" id="connectionStatus">
        <div class="loading-spinner"></div>
        <span id="connectionStatusText">Connecting...</span>
    </div>

    <!-- Benchmark Modal -->
    <div class="modal" id="benchmarkModal" aria-hidden="true">
        <div class="modal-backdrop" id="benchmarkBackdrop"></div>
        <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="benchmarkTitle" aria-describedby="benchmarkSummary">
            <div class="modal-header">
                <div>
                    <h2 id="benchmarkTitle">Model benchmarking lab</h2>
                    <p id="benchmarkSummary">Compare latency, throughput, and accelerator recommendations before you run long GPU jobs.</p>
                </div>
                <button class="modal-close" id="benchmarkClose" aria-label="Close benchmarking insights">
                    <i class="fa-solid fa-xmark" aria-hidden="true"></i>
                </button>
            </div>
            <div class="modal-content">
                <section class="benchmark-section highlight">
                    <h3>Run the AssistMe benchmark locally or in the cloud</h3>
                    <p>Install our open benchmark pack, point it at your API key, and capture GPU metrics automatically.</p>
                    <div class="benchmark-command-line">
                        <code id="benchmarkCommand">curl -fsSL https://get.assistme.ai/bench.sh | bash</code>
                        <button class="command-copy" id="benchmarkCopy" aria-label="Copy benchmark command">
                            <i class="fa-solid fa-copy" aria-hidden="true"></i>
                            Copy
                        </button>
                    </div>
                    <div class="benchmark-tags">
                        <span class="badge">Supports A100 / H100 / RTX 4090</span>
                        <span class="badge">Tracks cost + latency</span>
                        <span class="badge">Exports to CSV & Grafana</span>
                    </div>
                </section>

                <section class="benchmark-section">
                    <div class="section-heading">
                        <h3>Compare scenarios</h3>
                        <a class="benchmark-doc-link" href="https://github.com/mangeshraut712/AssistMe-VirtualAssistant/wiki/Benchmarking" target="_blank" rel="noopener">Read benchmarking guide<i class="fa-solid fa-arrow-up-right-from-square" aria-hidden="true"></i></a>
                    </div>
                    <div class="benchmark-tabs" id="benchmarkTabs" role="tablist">
                        <button type="button" class="benchmark-tab" data-scenario="general" role="tab" aria-selected="true">General Q&A</button>
                        <button type="button" class="benchmark-tab" data-scenario="coding" role="tab" aria-selected="false">Coding & reasoning</button>
                        <button type="button" class="benchmark-tab" data-scenario="creative" role="tab" aria-selected="false">Creative writing</button>
                    </div>
                    <p class="benchmark-description" id="benchmarkDescription"></p>
                    <div class="benchmark-table-wrapper">
                        <table class="benchmark-table">
                            <thead>
                                <tr>
                                    <th scope="col">Model</th>
                                    <th scope="col">Latency (p95)</th>
                                    <th scope="col">Throughput</th>
                                    <th scope="col">Context</th>
                                    <th scope="col">Best for</th>
                                    <th scope="col">Accelerator</th>
                                </tr>
                            </thead>
                            <tbody id="benchmarkTableBody"></tbody>
                        </table>
                    </div>
                </section>

                <section class="benchmark-section">
                    <h3>Accelerator recommendations</h3>
                    <ul class="benchmark-accelerators" id="benchmarkAccelerators"></ul>
                    <div class="benchmark-links">
                        <a href="https://cloud.google.com/compute/docs/gpus" target="_blank" rel="noopener" class="badge-link">Reserve GPU on GCP</a>
                        <a href="https://www.latent.space/p/benchmarking" target="_blank" rel="noopener" class="badge-link">Benchmark methodology</a>
                        <a href="https://openrouter.ai/docs#benchmarks" target="_blank" rel="noopener" class="badge-link">OpenRouter model stats</a>
                    </div>
                </section>

                <section class="benchmark-section fine-print">
                    <h3>Pro tips</h3>
                    <ul>
                        <li>Warm the model for 3–5 requests before recording latency to avoid cold-start spikes.</li>
                        <li>Use <code>--accelerator=H100</code> to test the same prompt set across different GPUs.</li>
                        <li>Record both streaming latency and total completion time for a balanced comparison.</li>
                        <li>Tag benchmark runs with <code>--label "release-2025.02"</code> to track regressions over time.</li>
                    </ul>
                </section>
            </div>
        </div>
    </div>

    <!-- Voice conversation overlay -->
    <div class="voice-overlay" id="voiceOverlay" aria-hidden="true">
        <div class="voice-overlay-card" role="dialog" aria-live="assertive">
            <button type="button" class="voice-overlay-close" id="voiceOverlayClose" aria-label="Close voice console">
                <i class="fa-solid fa-xmark" aria-hidden="true"></i>
            </button>
            <canvas id="voiceWaveform" width="480" height="160" aria-hidden="true"></canvas>
            <div class="voice-overlay-status">
                <span id="voiceOverlayStatus">Voice mode idle</span>
                <span id="voiceOverlayHint">Powered by MiniMax streaming</span>
            </div>
            <button type="button" class="voice-overlay-button" id="voiceOverlayToggle" aria-label="Toggle live voice conversation">
                <span class="pulse-ring"></span>
                <i class="fa-solid fa-microphone-lines" aria-hidden="true"></i>
            </button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal" aria-hidden="true">
        <div class="modal-backdrop" id="settingsBackdrop"></div>
        <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
            <div class="modal-header">
                <div>
                    <h2 id="settingsTitle">Personalise AssistMe</h2>
                    <p>Set your default style, language, and voice so every response feels tailored.</p>
                </div>
                <button class="modal-close" id="settingsClose" aria-label="Close settings">
                    <i class="fa-solid fa-xmark" aria-hidden="true"></i>
                </button>
            </div>
            <div class="modal-content">
                <form id="preferenceForm" class="preferences-form">
                    <label for="preferenceLanguage">Preferred language</label>
                    <input type="text" id="preferenceLanguage" name="language" placeholder="e.g., en, hi" autocomplete="off">

                    <label for="preferenceStyle">Response style</label>
                    <input type="text" id="preferenceStyle" name="style" placeholder="Concise, code-first, pragmatic" autocomplete="off">

                    <label for="preferenceVoice">Voice (MiniMax Speech)</label>
                    <input type="text" id="preferenceVoice" name="voice" placeholder="speech-02 voice" autocomplete="off">

                    <label for="preferencePersona">Persona notes</label>
                    <textarea id="preferencePersona" name="persona" rows="3" placeholder="Mangesh-mode: concise, cite assumptions, give code."></textarea>

                    <button type="submit" class="primary-btn" id="preferenceSave">
                        <i class="fa-solid fa-floppy-disk" aria-hidden="true"></i>
                        Save preferences
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script defer src="https://cdn.jsdelivr.net/npm/marked@12.0.2/marked.min.js" crossorigin="anonymous"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" crossorigin="anonymous"></script>
    <script>
        (function () {
            const meta = document.querySelector('meta[name="assistme-api-base"]');
            const isLocal = ['localhost', '127.0.0.1', '0.0.0.0'].includes(window.location.hostname);
            if (!isLocal && meta && meta.content) {
                window.ASSISTME_API_BASE = meta.content.trim();
            }
        }());
    </script>
    <script defer src="script.js"></script>
</body>
</html>
