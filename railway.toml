[build]
builder = "NIXPACKS"

[build.env]
# Enable V2 runtime for better FastAPI support
NIXPACKS_V2 = "true"
# Specify exact Python version
NIXPACKS_PYTHON_VERSION = "3.11"

# Railway-specific package configuration
NIXPACKS_PKGS = "git libpq-dev libssl-dev"

[deploy]
# V2 runtime: uvicorn startup in backend directory
startCommand = "./start.sh"
healthcheckPath = "/health"
healthcheckTimeout = 300
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Railway V2 runtime settings
sleepApplication = false
railwayTomlPath = "railway.toml"

[env]
# Core Application
APP_URL = "https://assistme-virtualassistant-production.up.railway.app"
APP_NAME = "AssistMe Virtual Assistant"
DEV_MODE = "false"

# Database (auto-provided by Railway)
# DATABASE_URL - automatically set by Railway PostgreSQL

# Redis (auto-provided by Railway)
# REDIS_URL - automatically set by Railway Redis

# OpenRouter API Configuration
# OPENROUTER_API_KEY should be set as an environment variable in Railway dashboard
# DO NOT commit API keys to the repository
OPENROUTER_API_KEY = ""
OPENROUTER_BASE_URL = "https://openrouter.ai/api/v1"

# Grokipedia RAG Configuration
GROKIPEDIA_DEFAULT_ENABLED = "true"
GROKIPEDIA_DATA_PATH = "data/grokipedia.json"
GROKIPEDIA_EMBED_MODEL = "sentence-transformers/all-MiniLM-L6-v2"

# MiniMax Multimodal Configuration
# MINIMAX_API_KEY should be provided via Railway environment variables
MINIMAX_API_KEY = ""
MINIMAX_BASE_URL = "https://api.minimax.chat/v1"
MINIMAX_AGENT_MODEL = "minimax/minimax-m2"
MINIMAX_TTS_MODEL = "speech-02"
MINIMAX_IMAGE_MODEL = "image-01"
MINIMAX_VIDEO_MODEL = "hailuo-02"

# GitHub Integration (optional)
GITHUB_TOKEN = ""
GITHUB_DEFAULT_REPO = ""
